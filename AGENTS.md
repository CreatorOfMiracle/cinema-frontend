# Инструкции для Codex (проект + ТЗ)

Этот файл читает Codex при работе с репозиторием. Здесь зафиксированы техстек, правила и текущее ТЗ.

## Контекст проекта
- Что это за проект: личный кабинет кассира кинотеатра (раздел управления сеансами и бронями).
- Техстек (клиент): Next.js (React), TypeScript, Tailwind CSS, shadcn/ui, TanStack Query (React Query).
- Сервер/БД: отдельный репозиторий (Node.js + REST-like API + БД).
- Версия Node: 20 LTS (если не скажешь иначе).
- Менеджер пакетов: `npm`.
- Как запускать локально: уточним после инициализации проекта (скрипты в `package.json`).
- Как собирать/деплоить: уточним после инициализации проекта.

## Правила работы
- Стиль: TypeScript строго, без `any` (если не оправдано), аккуратные типы для DTO.
- UI: Tailwind + shadcn/ui, формы/диалоги через компоненты shadcn, уведомления через toast.
- Данные: загрузка/мутации через TanStack Query; серверные ошибки показывать понятным уведомлением.
- Архитектура: разделять `api`/`hooks`/`components`/`features` (точную структуру закрепим при старте).

## Текущее ТЗ
### Цель
Разработать клиент‑серверное приложение для управления сеансами и бронями билетов (CRUD) с REST-like API и хранением данных в БД.

### Функциональные требования
**Сеансы (sessions)**  
- Показать список сеансов.
- Добавить новый сеанс.
- Редактировать сеанс (кроме `id`).
- Удалить сеанс.
- Поля сеанса: `id` (строка, нередактируемый), название фильма (строка), дата/время (дата), длительность (часы/минуты), зал (выбор из списка).
- Залы заданы изначально: `id`, наименование, вместимость.
- Между сеансами в одном зале должна быть техническая пауза `M` минут (задается разработчиком).
- При добавлении/редактировании сеанса проверить, что он не пересекается по времени с любым другим сеансом в том же зале с учетом паузы `M`.

**Брони (bookings) внутри сеанса**  
- Для каждого сеанса показать список броней.
- Добавить бронь.
- Удалить бронь.
- Перебросить бронь с одного сеанса на другой, только если у целевого сеанса тот же фильм.
- Параметры брони: `id` (строка, нередактируемый), ФИО (строка), количество билетов (целое).
- Если создается бронь от того же человека на тот же сеанс — билеты суммируются (новая запись не создается).
- В одни руки не более `N` билетов (задается разработчиком).
- При добавлении/редактировании брони проверять:
  - хватает ли мест в зале (с учетом всех броней на сеанс),
  - не превышен ли лимит `N` для данного ФИО на данном сеансе.
- Если изменения невозможны — показывать уведомление‑предупреждение и не применять изменение.

### Нефункциональные требования
- Производительность: быстрые списки, оптимистичные обновления где уместно, кеширование запросов через React Query.
- Доступность (a11y): shadcn/ui + корректные `label`, фокус, клавиатурная навигация в диалогах.
- i18n: русский интерфейс (i18n не обязателен, если не потребуется).

### Ограничения и допущения
**Выбор констант (можно поменять):**
- `M = 10` минут технической паузы.
- `N = 6` билетов в одни руки на 1 сеанс.

**Начальные данные залов (можно поменять):**
- `hall-1`: Зал 1, вместимость 60
- `hall-2`: Зал 2, вместимость 90
- `hall-3`: VIP, вместимость 30

**Правило пересечения сеансов (в одном зале):**  
Сеансы конфликтуют, если интервалы времени пересекаются с учетом паузы `M` минут между окончанием одного и началом другого.

### Ссылки/материалы

### Критерии приемки
- Реализованы CRUD для сеансов и броней.
- Нельзя создать/обновить сеанс, если есть пересечение в том же зале с учетом `M`.
- Нельзя создать/обновить бронь, если нет мест или превышен лимит `N`; показывается предупреждение.
- Перенос брони возможен только на сеанс с тем же фильмом.
- Повторная бронь того же ФИО на тот же сеанс суммирует билеты (без создания новой записи).
